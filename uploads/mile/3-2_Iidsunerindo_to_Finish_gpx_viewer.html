<!DOCTYPE html>
<html>
<head>
    <title>飯綱林道toFinish</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <style>
        #map, #graph {
            width: 100%;
            height: 50vh;
        }
        #slider-container {
            display: flex;
            justify-content: center;
            margin-top: 0px;
        }
        #slider {
            width: 100%;
        }
        #distances, #elevations, #checkpoint_time {
            text-align: center;
            margin-top: 10px;
        }        
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
</head>
<body>
    <div id="title"><a>飯綱林道toFinish</a></div>
    <div id="map"></div>
    <div id="graph" style="touch-action: manipulation;"></div>
    <div id="slider-container">
        <input type="range" id="slider" min="0" max="100" value="0" />
    </div>
    <div id="distances">
        <p>水平距離: <span id="horizontal-distance"></span> km</p>
        <p>沿面距離: <span id="surface-distance"></span> km</p>
    </div>
    <div id="elevations">
        <p>累積標高上り: <span id="total-ascent"></span> m</p>
        <p>累積標高下り: <span id="total-descent"></span> m</p>
        <p>最高標高: <span id="max-elevation"></span> m</p>
        <p>最低標高: <span id="min-elevation"></span> m</p>
    </div>
    <div id="checkpoint_time"><a>Finish制限時間 16日（月）03：30</a></div>
    <div>
        <a href="3-2_Iidsunerindo_to_Finish.gpx" download>GPXファイルをダウンロード</a>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
　　<script>
        $(document).ready(function() {
            // 地図の初期化
            var map = L.map('map').setView([36.73654, 138.0964], 14);
            L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png', {
                maxZoom: 18,
                attribution: '&copy; <a href="https://maps.gsi.go.jp/development/ichiran.html">国土地理院</a>'
            }).addTo(map);

            // GPXトラックの表示
            var latlngs = [
                
                    [36.73654, 138.0964, 1219,],

                    [36.73616, 138.09695, 1226,],

                    [36.73598, 138.09707, 1224,],

                    [36.73564, 138.09772, 1221,],

                    [36.73551, 138.09793, 1219,],

                    [36.73547, 138.09824, 1224,],

                    [36.73543, 138.09844, 1224,],

                    [36.73512, 138.09877, 1219,],

                    [36.73509, 138.09898, 1217,],

                    [36.73508, 138.09959, 1221,],

                    [36.73503, 138.09972, 1219,],

                    [36.73488, 138.09975, 1217,],

                    [36.73482, 138.09976, 1217,],

                    [36.73478, 138.0998, 1218,],

                    [36.73473, 138.10006, 1221,],

                    [36.73468, 138.10019, 1221,],

                    [36.73459, 138.10021, 1221,],

                    [36.73448, 138.1001, 1218,],

                    [36.73434, 138.09989, 1217,],

                    [36.73429, 138.09982, 1215,],

                    [36.73423, 138.09981, 1216,],

                    [36.73417, 138.09982, 1216,],

                    [36.73409, 138.09989, 1218,],

                    [36.73396, 138.10003, 1219,],

                    [36.73387, 138.10007, 1220,],

                    [36.73377, 138.10006, 1222,],

                    [36.73361, 138.09994, 1220,],

                    [36.73352, 138.09991, 1221,],

                    [36.73343, 138.09992, 1220,],

                    [36.73325, 138.10006, 1222,],

                    [36.73305, 138.10019, 1220,],

                    [36.73286, 138.10027, 1218,],

                    [36.73276, 138.10032, 1215,],

                    [36.73262, 138.10051, 1216,],

                    [36.73254, 138.10062, 1216,],

                    [36.73243, 138.10085, 1218,],

                    [36.73241, 138.10097, 1216,],

                    [36.73249, 138.10113, 1221,],

                    [36.73261, 138.10136, 1219,],

                    [36.73273, 138.1016, 1220,],

                    [36.73282, 138.10184, 1219,],

                    [36.73286, 138.10197, 1223,],

                    [36.73279, 138.10221, 1218,],

                    [36.7328, 138.10236, 1218,],

                    [36.73287, 138.1025, 1220,],

                    [36.73291, 138.10263, 1221,],

                    [36.73297, 138.10298, 1221,],

                    [36.73298, 138.10316, 1220,],

                    [36.73293, 138.10326, 1217,],

                    [36.73282, 138.10328, 1213,],

                    [36.73253, 138.10312, 1212,],

                    [36.73234, 138.10312, 1215,],

                    [36.73189, 138.10301, 1215,],

                    [36.73121, 138.1029, 1216,],

                    [36.73101, 138.10301, 1214,],

                    [36.73101, 138.10312, 1214,],

                    [36.73106, 138.10321, 1214,],

                    [36.7314, 138.10361, 1216,],

                    [36.73179, 138.10405, 1214,],

                    [36.73203, 138.10435, 1214,],

                    [36.73231, 138.10478, 1214,],

                    [36.73241, 138.10517, 1213,],

                    [36.7324, 138.10546, 1215,],

                    [36.73236, 138.10581, 1217,],

                    [36.7322, 138.1064, 1218,],

                    [36.73215, 138.10647, 1218,],

                    [36.73185, 138.10642, 1216,],

                    [36.73169, 138.10639, 1217,],

                    [36.73142, 138.10635, 1214,],

                    [36.73135, 138.10632, 1213,],

                    [36.73119, 138.10641, 1215,],

                    [36.73104, 138.10654, 1213,],

                    [36.73081, 138.10672, 1215,],

                    [36.73059, 138.10676, 1216,],

                    [36.73038, 138.10676, 1216,],

                    [36.73028, 138.10677, 1213,],

                    [36.73022, 138.10685, 1214,],

                    [36.73015, 138.10713, 1214,],

                    [36.7301, 138.10742, 1215,],

                    [36.72999, 138.1078, 1217,],

                    [36.72988, 138.10797, 1218,],

                    [36.72981, 138.10804, 1218,],

                    [36.72972, 138.10805, 1218,],

                    [36.7296, 138.10795, 1218,],

                    [36.72931, 138.10759, 1217,],

                    [36.72922, 138.10751, 1217,],

                    [36.72914, 138.10748, 1217,],

                    [36.72899, 138.10756, 1214,],

                    [36.72899, 138.10777, 1214,],

                    [36.72906, 138.10823, 1216,],

                    [36.72904, 138.10845, 1213,],

                    [36.72899, 138.10903, 1214,],

                    [36.729, 138.10938, 1215,],

                    [36.72898, 138.10954, 1216,],

                    [36.72892, 138.10966, 1217,],

                    [36.72887, 138.1097, 1218,],

                    [36.72879, 138.10968, 1218,],

                    [36.72865, 138.10942, 1217,],

                    [36.7283, 138.10844, 1211,],

                    [36.72809, 138.10809, 1212,],

                    [36.72791, 138.10787, 1214,],

                    [36.72772, 138.10767, 1212,],

                    [36.72748, 138.10753, 1213,],

                    [36.72722, 138.10735, 1216,],

                    [36.727, 138.10709, 1217,],

                    [36.72685, 138.1069, 1215,],

                    [36.72668, 138.10676, 1211,],

                    [36.72638, 138.10661, 1203,],

                    [36.72602, 138.10652, 1206,],

                    [36.72582, 138.10643, 1205,],

                    [36.72577, 138.10643, 1205,],

                    [36.72568, 138.10643, 1205,],

                    [36.7256, 138.10646, 1204,],

                    [36.72559, 138.10669, 1206,],

                    [36.72559, 138.10678, 1206,],

                    [36.72551, 138.10683, 1207,],

                    [36.72542, 138.10683, 1207,],

                    [36.72531, 138.10675, 1206,],

                    [36.72522, 138.10662, 1204,],

                    [36.72515, 138.10657, 1205,],

                    [36.72508, 138.10657, 1206,],

                    [36.72494, 138.10663, 1206,],

                    [36.7248, 138.10672, 1206,],

                    [36.7247, 138.10685, 1206,],

                    [36.72464, 138.10701, 1204,],

                    [36.7248, 138.10753, 1208,],

                    [36.72488, 138.10793, 1205,],

                    [36.7249, 138.10834, 1204,],

                    [36.72486, 138.10861, 1205,],

                    [36.72476, 138.10881, 1203,],

                    [36.72473, 138.10884, 1203,],

                    [36.72464, 138.10884, 1204,],

                    [36.72447, 138.10869, 1203,],

                    [36.72422, 138.10842, 1204,],

                    [36.72399, 138.1084, 1207,],

                    [36.72381, 138.10836, 1210,],

                    [36.72362, 138.10834, 1213,],

                    [36.72345, 138.1083, 1213,],

                    [36.72332, 138.10833, 1213,],

                    [36.72321, 138.10839, 1214,],

                    [36.72316, 138.10853, 1212,],

                    [36.72314, 138.10858, 1212,],

                    [36.7231, 138.10866, 1212,],

                    [36.72301, 138.10875, 1213,],

                    [36.72276, 138.10881, 1213,],

                    [36.72261, 138.10885, 1211,],

                    [36.72256, 138.10894, 1211,],

                    [36.72253, 138.10919, 1212,],

                    [36.72258, 138.10942, 1212,],

                    [36.72253, 138.10958, 1214,],

                    [36.72243, 138.10967, 1213,],

                    [36.72231, 138.10983, 1213,],

                    [36.7223, 138.11003, 1211,],

                    [36.72243, 138.11029, 1212,],

                    [36.7225, 138.11055, 1211,],

                    [36.72255, 138.11074, 1213,],

                    [36.72254, 138.1108, 1213,],

                    [36.72249, 138.11088, 1215,],

                    [36.72245, 138.11092, 1215,],

                    [36.72234, 138.11093, 1215,],

                    [36.72224, 138.11092, 1214,],

                    [36.72214, 138.11097, 1216,],

                    [36.72208, 138.11105, 1216.2,],

                    [36.72209, 138.11128, 1214.6,],

                    [36.72229, 138.11181, 1214,],

                    [36.72243, 138.11207, 1216.5,],

                    [36.72261, 138.11261, 1218.8,],

                    [36.72271, 138.11297, 1220.9,],

                    [36.72272, 138.11308, 1222.8,],

                    [36.7227, 138.11329, 1224.3,],

                    [36.72264, 138.11339, 1227.7,],

                    [36.72249, 138.11336, 1230.2,],

                    [36.72239, 138.1133, 1231.9,],

                    [36.72224, 138.1133, 1233,],

                    [36.7221, 138.11328, 1232,],

                    [36.72201, 138.11316, 1230.8,],

                    [36.7219, 138.11306, 1231.2,],

                    [36.72182, 138.11305, 1231.9,],

                    [36.72168, 138.11306, 1231.9,],

                    [36.72158, 138.1131, 1230.9,],

                    [36.72153, 138.11318, 1231.2,],

                    [36.72148, 138.11353, 1231.2,],

                    [36.72151, 138.11377, 1231.1,],

                    [36.7215, 138.11386, 1229.6,],

                    [36.72153, 138.11399, 1227.6,],

                    [36.72161, 138.11415, 1225.3,],

                    [36.72168, 138.11431, 1224.2,],

                    [36.72168, 138.11438, 1225,],

                    [36.72167, 138.11443, 1225,],

                    [36.72163, 138.11445, 1225,],

                    [36.72158, 138.11443, 1224,],

                    [36.72138, 138.11438, 1224,],

                    [36.72122, 138.11438, 1221,],

                    [36.72106, 138.11442, 1215,],

                    [36.72077, 138.11458, 1215,],

                    [36.72046, 138.11479, 1214,],

                    [36.7203, 138.11491, 1213,],

                    [36.72022, 138.115, 1212,],

                    [36.72021, 138.11515, 1212,],

                    [36.72028, 138.11529, 1213,],

                    [36.72032, 138.11542, 1211,],

                    [36.72038, 138.11559, 1208,],

                    [36.72036, 138.1157, 1206,],

                    [36.72027, 138.11582, 1205,],

                    [36.72016, 138.11596, 1205,],

                    [36.72014, 138.11616, 1206,],

                    [36.72022, 138.11651, 1204,],

                    [36.72038, 138.11685, 1206,],

                    [36.72043, 138.11693, 1206,],

                    [36.72039, 138.11745, 1206,],

                    [36.72032, 138.11755, 1205,],

                    [36.72028, 138.11769, 1204,],

                    [36.72027, 138.11783, 1204,],

                    [36.72035, 138.11806, 1204,],

                    [36.72034, 138.11836, 1203,],

                    [36.72033, 138.11867, 1203,],

                    [36.7207, 138.11929, 1204,],

                    [36.72084, 138.11957, 1204,],

                    [36.72083, 138.11981, 1205,],

                    [36.72081, 138.12004, 1205,],

                    [36.72084, 138.12015, 1204,],

                    [36.72097, 138.1205, 1204,],

                    [36.72106, 138.12079, 1204,],

                    [36.721, 138.12095, 1205,],

                    [36.72097, 138.12106, 1205,],

                    [36.72069, 138.12151, 1211,],

                    [36.72062, 138.12165, 1210,],

                    [36.72065, 138.12184, 1210,],

                    [36.72062, 138.12211, 1205,],

                    [36.72062, 138.12239, 1203,],

                    [36.72075, 138.12276, 1204,],

                    [36.72106, 138.12313, 1206,],

                    [36.7211, 138.1234, 1205,],

                    [36.72109, 138.12358, 1206,],

                    [36.72099, 138.12387, 1207,],

                    [36.72086, 138.124, 1208,],

                    [36.72066, 138.12409, 1208,],

                    [36.72044, 138.12419, 1206,],

                    [36.7204, 138.12426, 1207,],

                    [36.72042, 138.1245, 1206,],

                    [36.7205, 138.12472, 1207,],

                    [36.72041, 138.12499, 1207,],

                    [36.72024, 138.12544, 1207,],

                    [36.72023, 138.1255, 1207,],

                    [36.72024, 138.12569, 1207,],

                    [36.72042, 138.12591, 1208,],

                    [36.72045, 138.1261, 1208,],

                    [36.72036, 138.12632, 1207,],

                    [36.72034, 138.12645, 1207,],

                    [36.7203, 138.12671, 1206,],

                    [36.7203, 138.12675, 1206,],

                    [36.7203, 138.12698, 1205,],

                    [36.7204, 138.12725, 1206,],

                    [36.7206, 138.12754, 1208,],

                    [36.72065, 138.12764, 1208,],

                    [36.72064, 138.12773, 1207,],

                    [36.72062, 138.12776, 1207,],

                    [36.72055, 138.12788, 1206,],

                    [36.72051, 138.12801, 1205,],

                    [36.72052, 138.12836, 1204,],

                    [36.72051, 138.12857, 1202,],

                    [36.72033, 138.12885, 1201,],

                    [36.72018, 138.12907, 1199,],

                    [36.72014, 138.12919, 1198,],

                    [36.72007, 138.1294, 1196,],

                    [36.72008, 138.12963, 1195,],

                    [36.72006, 138.12988, 1194,],

                    [36.71987, 138.13029, 1189,],

                    [36.71956, 138.13092, 1185,],

                    [36.71944, 138.13124, 1183,],

                    [36.71949, 138.13152, 1181,],

                    [36.71957, 138.1319, 1178,],

                    [36.71951, 138.13204, 1177,],

                    [36.71942, 138.13211, 1175,],

                    [36.7193, 138.13212, 1174,],

                    [36.71899, 138.13193, 1168,],

                    [36.7189, 138.13189, 1168,],

                    [36.71883, 138.13194, 1167,],

                    [36.71882, 138.13221, 1167,],

                    [36.71879, 138.13252, 1164,],

                    [36.71872, 138.13267, 1162,],

                    [36.71858, 138.13298, 1158,],

                    [36.71844, 138.13409, 1149,],

                    [36.71841, 138.13467, 1144,],

                    [36.71845, 138.13484, 1141,],

                    [36.71846, 138.13485, 1141,],

                    [36.71859, 138.13493, 1140,],

                    [36.71879, 138.13501, 1140,],

                    [36.71894, 138.13507, 1140,],

                    [36.719, 138.13511, 1140,],

                    [36.71902, 138.13521, 1140,],

                    [36.71887, 138.13544, 1138,],

                    [36.71885, 138.13563, 1138,],

                    [36.71883, 138.13623, 1134,],

                    [36.71908, 138.13661, 1133,],

                    [36.71971, 138.13723, 1132,],

                    [36.71991, 138.13738, 1126,],

                    [36.72004, 138.13738, 1127,],

                    [36.72019, 138.13746, 1127,],

                    [36.72014, 138.13764, 1126,],

                    [36.72, 138.13784, 1124,],

                    [36.71988, 138.13796, 1122,],

                    [36.71977, 138.13812, 1123,],

                    [36.71974, 138.13823, 1124,],

                    [36.71974, 138.13858, 1125,],

                    [36.71979, 138.13889, 1126,],

                    [36.71984, 138.1391, 1125,],

                    [36.71979, 138.13923, 1125,],

                    [36.71943, 138.13943, 1121,],

                    [36.71934, 138.13949, 1117,],

                    [36.7193, 138.13964, 1118,],

                    [36.7193, 138.13965, 1118,],

                    [36.71915, 138.13971, 1118,],

                    [36.71886, 138.13976, 1114,],

                    [36.71883, 138.13977, 1114,],

                    [36.71848, 138.14011, 1115,],

                    [36.71838, 138.14022, 1116,],

                    [36.71838, 138.14044, 1117,],

                    [36.71875, 138.14096, 1121,],

                    [36.71897, 138.14121, 1120,],

                    [36.71923, 138.14137, 1123,],

                    [36.71926, 138.1414, 1123,],

                    [36.71929, 138.14168, 1124,],

                    [36.71939, 138.14188, 1124,],

                    [36.71957, 138.14202, 1123,],

                    [36.71986, 138.14208, 1126,],

                    [36.72021, 138.14227, 1124,],

                    [36.72043, 138.14232, 1126,],

                    [36.72066, 138.14238, 1121,],

                    [36.72097, 138.14238, 1121,],

                    [36.72113, 138.14232, 1124,],

                    [36.72129, 138.14231, 1123,],

                    [36.7216, 138.14247, 1118,],

                    [36.72188, 138.14263, 1111,],

                    [36.72202, 138.14267, 1112,],

                    [36.72223, 138.14268, 1112,],

                    [36.72235, 138.14276, 1110,],

                    [36.7224, 138.14281, 1109,],

                    [36.72252, 138.14297, 1111,],

                    [36.72257, 138.14312, 1111,],

                    [36.72257, 138.14312, 1111,],

                    [36.72257, 138.14331, 1111,],

                    [36.72255, 138.14342, 1111,],

                    [36.72253, 138.14346, 1111,],

                    [36.72238, 138.14355, 1108,],

                    [36.72229, 138.14363, 1106,],

                    [36.72227, 138.1437, 1106,],

                    [36.72226, 138.1438, 1106,],

                    [36.72225, 138.14391, 1106,],

                    [36.72226, 138.14396, 1106,],

                    [36.72231, 138.14405, 1106,],

                    [36.72237, 138.14417, 1106,],

                    [36.7224, 138.14424, 1107,],

                    [36.72246, 138.14432, 1108,],

                    [36.7225, 138.1444, 1108,],

                    [36.72251, 138.14443, 1107,],

                    [36.72252, 138.14453, 1108,],

                    [36.72251, 138.1446, 1107,],

                    [36.7225, 138.14467, 1107,],

                    [36.72255, 138.14479, 1107,],

                    [36.72261, 138.14487, 1107,],

                    [36.72264, 138.14494, 1107,],

                    [36.72265, 138.14497, 1109,],

                    [36.72265, 138.14501, 1109,],

                    [36.72265, 138.14505, 1109,],

                    [36.72266, 138.14509, 1109,],

                    [36.72268, 138.14521, 1109,],

                    [36.72273, 138.14531, 1110,],

                    [36.72278, 138.14537, 1110,],

                    [36.7228, 138.14539, 1111,],

                    [36.72281, 138.14543, 1111,],

                    [36.72281, 138.14549, 1111,],

                    [36.72281, 138.14552, 1111,],

                    [36.72277, 138.14563, 1110,],

                    [36.72276, 138.1458, 1111,],

                    [36.72275, 138.14586, 1111,],

                    [36.72274, 138.14592, 1111,],

                    [36.72271, 138.14599, 1111,],

                    [36.72273, 138.14606, 1112,],

                    [36.72276, 138.1462, 1113,],

                    [36.72279, 138.14633, 1115,],

                    [36.72286, 138.14643, 1116,],

                    [36.72298, 138.14656, 1115,],

                    [36.723, 138.14658, 1116,],

                    [36.72306, 138.14668, 1114,],

                    [36.72307, 138.14668, 1115,],

                    [36.72313, 138.14668, 1115,],

                    [36.72326, 138.14666, 1117,],

                    [36.72336, 138.14666, 1119,],

                    [36.72344, 138.1467, 1120,],

                    [36.72353, 138.14672, 1121,],

                    [36.72356, 138.14672, 1122,],

                    [36.72364, 138.14671, 1123,],

                    [36.72369, 138.14674, 1122,],

                    [36.72373, 138.14676, 1122,],

                    [36.72377, 138.14677, 1123,],

                    [36.72382, 138.14678, 1124,],

                    [36.72387, 138.14678, 1124,],

                    [36.72391, 138.14679, 1125,],

                    [36.72399, 138.14681, 1126,],

                    [36.72401, 138.14681, 1126,],

                    [36.72409, 138.14687, 1125,],

                    [36.72418, 138.14689, 1126,],

                    [36.72419, 138.1469, 1124,],

                    [36.72423, 138.14698, 1124,],

                    [36.72422, 138.14709, 1120,],

                    [36.72421, 138.14711, 1120,],

                    [36.72412, 138.14713, 1120,],

                    [36.72403, 138.14717, 1118,],

                    [36.72401, 138.14729, 1115,],

                    [36.72403, 138.1474, 1115,],

                    [36.72407, 138.14748, 1113,],

                    [36.72412, 138.1476, 1111,],

                    [36.72413, 138.14773, 1109,],

                    [36.72412, 138.14784, 1108,],

                    [36.72416, 138.14797, 1105,],

                    [36.72419, 138.14818, 1102,],

                    [36.7242, 138.14819, 1100,],

                    [36.72427, 138.14822, 1099,],

                    [36.72437, 138.14827, 1095,],

                    [36.72446, 138.14828, 1094,],

                    [36.72448, 138.14828, 1094,],

                    [36.72458, 138.14825, 1096,],

                    [36.72467, 138.14824, 1095,],

                    [36.72476, 138.14827, 1092,],

                    [36.72485, 138.14829, 1092,],

                    [36.72494, 138.14833, 1091,],

                    [36.72499, 138.14843, 1088,],

                    [36.72492, 138.14859, 1085,],

                    [36.72488, 138.14867, 1083,],

                    [36.72483, 138.14875, 1082,],

                    [36.72477, 138.14882, 1081,],

                    [36.72471, 138.14892, 1079,],

                    [36.72464, 138.149, 1075,],

                    [36.72458, 138.14909, 1072,],

                    [36.72449, 138.14914, 1070,],

                    [36.7244, 138.14917, 1071,],

                    [36.72435, 138.14928, 1071,],

                    [36.72433, 138.14938, 1071,],

                    [36.72437, 138.14942, 1068,],

                    [36.72441, 138.14945, 1068,],

                    [36.7245, 138.14943, 1065,],

                    [36.72456, 138.14935, 1065,],

                    [36.72463, 138.14932, 1065,],

                    [36.72472, 138.14933, 1065,],

                    [36.72479, 138.14938, 1064,],

                    [36.72483, 138.14951, 1062,],

                    [36.72481, 138.14993, 1062,],

                    [36.72481, 138.15005, 1062,],

                    [36.72489, 138.15028, 1062,],

                    [36.72497, 138.1504, 1062,],

                    [36.72511, 138.15045, 1063,],

                    [36.72518, 138.15051, 1064,],

                    [36.72521, 138.15068, 1065,],

                    [36.72522, 138.15091, 1063,],

                    [36.72528, 138.15102, 1063,],

                    [36.7254, 138.15116, 1062,],

                    [36.72553, 138.15117, 1064,],

                    [36.72584, 138.15113, 1065,],

                    [36.72601, 138.15114, 1065,],

                    [36.72613, 138.15127, 1064,],

                    [36.72643, 138.15177, 1066,],

                    [36.72657, 138.15177, 1068,],

                    [36.72667, 138.15178, 1069,],

                    [36.72689, 138.15203, 1066,],

                    [36.72706, 138.15227, 1067,],

                    [36.7271, 138.15266, 1066,],

                    [36.72708, 138.153, 1057,],

                    [36.72718, 138.15332, 1053,],

                    [36.72734, 138.15352, 1051,],

                    [36.7275, 138.15365, 1050,],

                    [36.72773, 138.15366, 1051,],

                    [36.72817, 138.15349, 1055,],

                    [36.72826, 138.1534, 1057,],

                    [36.72839, 138.15341, 1055,],

                    [36.72854, 138.15356, 1049,],

                    [36.72891, 138.15398, 1047,],

                    [36.72904, 138.1542, 1048,],

                    [36.72917, 138.1542, 1051,],

                    [36.72948, 138.15414, 1058,],

                    [36.72977, 138.15414, 1058.3,],

                    [36.73007, 138.15412, 1061,],

                    [36.73013, 138.15418, 1063.1,],

                    [36.7302, 138.15458, 1064.5,],

                    [36.73034, 138.15479, 1067.2,],

                    [36.73045, 138.15487, 1068,],

                    [36.73064, 138.15488, 1070.2,],

                    [36.73078, 138.15485, 1072.2,],

                    [36.73089, 138.15478, 1073.4,],

                    [36.73099, 138.15461, 1075.1,],

                    [36.73108, 138.15433, 1076.9,],

                    [36.73107, 138.15402, 1081.6,],

                    [36.73113, 138.15357, 1082,],

                    [36.73122, 138.15326, 1085,],

                    [36.73136, 138.15317, 1078.3,],

                    [36.73145, 138.15317, 1076.4,],

                    [36.7316, 138.15336, 1076.1,],

                    [36.73161, 138.15372, 1076.7,],

                    [36.73161, 138.15462, 1071.3,],

                    [36.73158, 138.15475, 1071,],

                    [36.73159, 138.15532, 1072.4,],

                    [36.73165, 138.15561, 1071.7,],

                    [36.73196, 138.15566, 1075.1,],

                    [36.73226, 138.15571, 1077,],

                    [36.73245, 138.15574, 1077.5,],

                    [36.73258, 138.15573, 1079.1,],

                    [36.73301, 138.15552, 1083.6,],

                    [36.73314, 138.15543, 1085.1,],

                    [36.73349, 138.15545, 1087.5,],

                    [36.73365, 138.15533, 1087.3,],

                    [36.73372, 138.15507, 1089,],

                    [36.73376, 138.15494, 1090.5,],

                    [36.73398, 138.15478, 1093.2,],

                    [36.73421, 138.15461, 1093.8,],

                    [36.73427, 138.15449, 1094.1,],

                    [36.73431, 138.15424, 1095.5,],

                    [36.73432, 138.15409, 1097.4,],

                    [36.73445, 138.15393, 1098.4,],

                    [36.73457, 138.15388, 1098.6,],

                    [36.73474, 138.15393, 1099,],

                    [36.73489, 138.15415, 1100.8,],

                    [36.73499, 138.15449, 1103,],

                    [36.73512, 138.15476, 1103.7,],

                    [36.73522, 138.15484, 1103.6,],

                    [36.73533, 138.15483, 1104,],

                    [36.73539, 138.15476, 1105.4,],

                    [36.7355, 138.15477, 1107.3,],

                    [36.73554, 138.15487, 1107,],

                    [36.73562, 138.15511, 1106.8,],

                    [36.73572, 138.15525, 1107.2,],

                    [36.73583, 138.15545, 1110.4,],

                    [36.73593, 138.15563, 1113,],

                    [36.736, 138.15571, 1113.5,],

                    [36.73609, 138.15578, 1113.1,],

                    [36.73622, 138.15579, 1115.1,],

                    [36.73684, 138.1556, 1122.5,],

                    [36.73688, 138.15574, 1118.7,],

                    [36.73691, 138.15583, 1116.2,],

                    [36.7369, 138.15617, 1109.3,],

                    [36.73689, 138.15648, 1104.7,],

                    [36.73692, 138.1568, 1097.6,],

                    [36.73691, 138.15689, 1096,],

                    [36.73679, 138.15728, 1090.9,],

                    [36.73676, 138.15743, 1089.5,],

                    [36.73676, 138.1576, 1087,],

                    [36.73683, 138.15788, 1079.8,],

                    [36.73682, 138.15808, 1075.6,],

                    [36.73679, 138.15843, 1071.2,],

                    [36.73678, 138.15912, 1060.7,],

                    [36.73678, 138.15973, 1053.6,],

                    [36.73684, 138.15994, 1051.1,],

                    [36.73689, 138.15999, 1048.1,],

                    [36.73695, 138.16003, 1045.7,],

                    [36.73707, 138.16002, 1040.9,],

                    [36.73719, 138.15992, 1040.7,],

                    [36.73725, 138.15973, 1040,],

                    [36.73738, 138.15971, 1041.7,],

                    [36.73742, 138.16029, 1036.1,],

                    [36.7374, 138.16092, 1029.6,],

                    [36.7374, 138.16174, 1021,],

                    [36.73731, 138.16199, 1017.2,],

                    [36.73739, 138.16223, 1013.6,],

                    [36.73724, 138.16249, 1008.9,],

                    [36.73701, 138.16267, 1007.1,],

                    [36.73702, 138.16294, 1004,],

                    [36.73709, 138.16307, 1002.3,],

                    [36.73758, 138.16352, 998.9,],

                    [36.73758, 138.16376, 996.9,],

                    [36.73752, 138.16451, 987.8,],

                    [36.7375, 138.16466, 986.3,],

                    [36.73775, 138.16477, 984.6,],

                    [36.73788, 138.16491, 983.2,],

                    [36.73803, 138.16506, 980.8,],

                    [36.73824, 138.16518, 979.3,],

                    [36.7384, 138.1653, 978.2,],

                    [36.73852, 138.16534, 977.6,],

                    [36.73865, 138.16568, 973.4,],

                    [36.73868, 138.16599, 970.7,],

                    [36.73843, 138.16616, 968.3,],

                    [36.73815, 138.16641, 967.5,],

                    [36.73812, 138.16645, 967.2,],

                    [36.73809, 138.16791, 953.1,],

                    [36.73807, 138.16908, 941.7,],

                    [36.73806, 138.17042, 929.5,],

                    [36.7377, 138.17043, 929.5,],

            ];
            var polyline = L.polyline(latlngs.map(function(latlng) { return [latlng[0], latlng[1]]; }), {color: 'blue'}).addTo(map);

            // 距離計算関数
            function calculateDistance(lat1, lon1, lat2, lon2) {
                function toRad(x) {
                    return x * Math.PI / 180;
                }
                var R = 6371; // 地球の半径 (km)
                var dLat = toRad(lat2 - lat1);
                var dLon = toRad(lon2 - lon1);
                var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                        Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
                        Math.sin(dLon / 2) * Math.sin(dLon / 2);
                var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
                return R * c;
            }

            // ローパスフィルタによる標高データのスムージング
            function lowPassFilter(elevations, alpha) {
                var smoothed = [elevations[0]]; // 初期値は最初の標高値
                for (var i = 1; i < elevations.length; i++) {
                    var smoothedValue = alpha * elevations[i] + (1 - alpha) * smoothed[i - 1];
                    smoothed.push(smoothedValue);
                }
                return smoothed;
            }

            // 累積距離計算 (水平距離)
            var distances = [0];
            var totalDistance = 0;
            for (var i = 1; i < latlngs.length; i++) {
                var d = calculateDistance(latlngs[i-1][0], latlngs[i-1][1], latlngs[i][0], latlngs[i][1]);
                totalDistance += d;
                distances.push(totalDistance);
            }

            // 累積距離計算 (沿面距離)
            function calculateSurfaceDistance(lat1, lon1, ele1, lat2, lon2, ele2) {
                var horizontalDistance = calculateDistance(lat1, lon1, lat2, lon2);
                var verticalDistance = (ele2 - ele1) / 1000; // m to km
                return Math.sqrt(horizontalDistance * horizontalDistance + verticalDistance * verticalDistance);
            }

            var surfaceDistances = [0];
            var totalSurfaceDistance = 0;
            for (var i = 1; i < latlngs.length; i++) {
                var d = calculateSurfaceDistance(latlngs[i-1][0], latlngs[i-1][1], latlngs[i-1][2], latlngs[i][0], latlngs[i][1], latlngs[i][2]);
                totalSurfaceDistance += d;
                surfaceDistances.push(totalSurfaceDistance);
            }

            // 標高データのスムージング
            var elevations = latlngs.map(function(latlng) { return latlng[2]; });
            var alpha = 0.167; // スムージング係数 (0.0 < alpha < 1.0)
            var smoothedElevations = lowPassFilter(elevations, alpha);

            // 累積標高計算
            var totalAscent = 0;
            var totalDescent = 0;
            var maxElevation = Math.max(...smoothedElevations);
            var minElevation = Math.min(...smoothedElevations);
            for (var i = 1; i < smoothedElevations.length; i++) {
                var diff = smoothedElevations[i] - smoothedElevations[i-1];
                if (diff > 0) {
                    totalAscent += diff;
                } else {
                    totalDescent += Math.abs(diff);
                }
            }

            // 水平距離と沿面距離の表示
            document.getElementById('horizontal-distance').innerText = totalDistance.toFixed(0);
            document.getElementById('surface-distance').innerText = totalSurfaceDistance.toFixed(0);

            // 累積標高と最高・最低標高の表示
            document.getElementById('total-ascent').innerText = totalAscent.toFixed(0);
            document.getElementById('total-descent').innerText = totalDescent.toFixed(0);
            document.getElementById('max-elevation').innerText = maxElevation.toFixed(0);
            document.getElementById('min-elevation').innerText = minElevation.toFixed(0);

            // 標高グラフの初期化
            var graphDiv = document.getElementById('graph');
            Plotly.newPlot(graphDiv, [{
                x: distances,
                y: smoothedElevations,
                type: 'scatter',
                mode: 'lines'
            }], {
                xaxis: { title: '距離 (km)' },
                yaxis: { title: '標高 (m)' }
            });

            // マーカーの初期化
            var marker = L.marker([latlngs[0][0], latlngs[0][1]]).addTo(map);

            // スライダーの設定
            var slider = document.getElementById('slider');
            slider.max = latlngs.length - 1;

            // マーカーとビューを更新する共通関数
            function updateMarkerAndView(idx) {
                var latlng = latlngs[idx];
                marker.setLatLng([latlng[0], latlng[1]]);
                map.setView([latlng[0], latlng[1]], 15);
                Plotly.Fx.hover('graph', [{
                    curveNumber: 0,
                    pointNumber: idx
                }]);
            }

            slider.addEventListener('input', function() {
                var idx = slider.value;
                updateMarkerAndView(idx);
            });

            // グラフのホバーイベント
            graphDiv.on('plotly_hover', function(eventdata) {
                var idx = eventdata.points[0].pointNumber;
                slider.value = idx;
                updateMarkerAndView(idx);
            });

            // グラフのクリックイベント
            graphDiv.on('plotly_click', function(eventdata) {
                var idx = eventdata.points[0].pointNumber;
                slider.value = idx;
                updateMarkerAndView(idx);
            });

            // 初期距離表示更新
            updateMarkerAndView(0);
        });
    </script>
</body>
</html>
